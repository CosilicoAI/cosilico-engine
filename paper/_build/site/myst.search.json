{"version":"1","records":[{"hierarchy":{"lvl1":"Abstract"},"type":"lvl1","url":"/abstract","position":0},{"hierarchy":{"lvl1":"Abstract"},"content":"Rules-as-code (RaC) promises to make legislation computable, but encoding statutes into executable form remains labor-intensive. We present an automated approach using large language models (LLMs) with reinforcement learning from implementation feedback (RLIF). Our system reads statutory text, generates code in a domain-specific language, and iteratively refines it based on test results from existing implementations (PolicyEngine, TAXSIM) used as oracles.\n\nWe evaluate on 15 provisions from the U.S. Internal Revenue Code, spanning simple formulas (EITC phase-in) to complex multi-branch logic (Alternative Minimum Tax). Key findings:\n\nConvergence: 80% of provisions reach ≥95% accuracy within 10 iterations\n\nCost efficiency: Mean cost of 0.50 per simple provision, 5 per complex provision\n\nTransfer learning: Later provisions require 25% fewer iterations than earlier ones of similar complexity\n\nFailure modes: Systematic failures cluster around ambiguous statutory language (40%), missing oracle coverage (30%), and temporal logic (20%)\n\nOur results suggest that AI can substantially automate rules-as-code encoding, with human oversight focused on edge cases and ambiguity resolution rather than formula implementation. We release all code, data, and preregistered hypotheses.\n\nKeywords: rules-as-code, large language models, reinforcement learning, tax policy, automated reasoning","type":"content","url":"/abstract","position":1},{"hierarchy":{"lvl1":"Appendix: Code Listings"},"type":"lvl1","url":"/appendix-code","position":0},{"hierarchy":{"lvl1":"Appendix: Code Listings"},"content":"This appendix contains key code from the Cosilico AI training system.","type":"content","url":"/appendix-code","position":1},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"Agent Training Loop"},"type":"lvl2","url":"/appendix-code#agent-training-loop","position":2},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"Agent Training Loop"},"content":"The core agentic loop that drives statute encoding:class AgentTrainingLoop:\n    \"\"\"Agentic training loop using Claude with tools.\"\"\"\n\n    def __init__(\n        self,\n        model: str = \"claude-sonnet-4-20250514\",\n        max_iterations: int = 10,\n        target_accuracy: float = 0.95,\n    ):\n        self.model = model\n        self.max_iterations = max_iterations\n        self.target_accuracy = target_accuracy\n        self.client = anthropic.Anthropic()\n\n    def train(self, statute: Statute, test_cases: list[TestCase]) -> dict:\n        \"\"\"Run the agentic training loop.\"\"\"\n        messages = [\n            {\"role\": \"user\", \"content\": self._build_prompt(statute, test_cases)}\n        ]\n\n        for turn in range(self.max_iterations * 2):\n            response = self.client.messages.create(\n                model=self.model,\n                max_tokens=4096,\n                system=self._build_system_prompt(),\n                tools=TOOLS,\n                messages=messages\n            )\n\n            # Handle tool calls\n            tool_uses = [b for b in response.content if b.type == \"tool_use\"]\n\n            if not tool_uses:\n                break\n\n            for tool_use in tool_uses:\n                result = self._handle_tool_call(tool_use.name, tool_use.input)\n                # ... process results\n\n        return {\"success\": self.best_accuracy >= self.target_accuracy, ...}","type":"content","url":"/appendix-code#agent-training-loop","position":3},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"Tool Definitions"},"type":"lvl2","url":"/appendix-code#tool-definitions","position":4},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"Tool Definitions"},"content":"Tools available to the Claude agent:TOOLS = [\n    {\n        \"name\": \"execute_dsl\",\n        \"description\": \"Execute Cosilico DSL code against test cases\",\n        \"input_schema\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"dsl_code\": {\"type\": \"string\"}\n            },\n            \"required\": [\"dsl_code\"]\n        }\n    },\n    {\n        \"name\": \"submit_final_code\",\n        \"description\": \"Submit final DSL code when accuracy target is met\",\n        \"input_schema\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"dsl_code\": {\"type\": \"string\"},\n                \"explanation\": {\"type\": \"string\"}\n            },\n            \"required\": [\"dsl_code\"]\n        }\n    }\n]","type":"content","url":"/appendix-code#tool-definitions","position":5},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"DSL Executor"},"type":"lvl2","url":"/appendix-code#dsl-executor","position":6},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"DSL Executor"},"content":"The executor that parses and runs generated DSL:class Executor:\n    def execute(self, code: GeneratedCode, test_cases: list[TestCase]):\n        parsed = self._parse(code.source)\n\n        results = []\n        for tc in test_cases:\n            try:\n                output = self._evaluate_formula(\n                    parsed[\"formula\"],\n                    tc.inputs,\n                    parsed[\"references\"]\n                )\n                match = abs(output - tc.expected[\"eitc\"]) <= 1.0\n                results.append(ExecutionResult(match=match, ...))\n            except Exception as e:\n                results.append(ExecutionResult(error=str(e)))\n\n        return results","type":"content","url":"/appendix-code#dsl-executor","position":7},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"Oracle Interface"},"type":"lvl2","url":"/appendix-code#oracle-interface","position":8},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"Oracle Interface"},"content":"PolicyEngine oracle wrapper:class PolicyEngineOracle:\n    def __init__(self, year: int = 2024):\n        from policyengine_us import Simulation\n        self.Simulation = Simulation\n        self.year = year\n\n    def evaluate(self, inputs: dict) -> dict:\n        situation = self._build_situation(inputs)\n        sim = self.Simulation(situation=situation)\n\n        return {\n            \"eitc\": float(sim.calculate(\"eitc\", self.year)),\n            \"earned_income\": float(sim.calculate(\"earned_income\", self.year)),\n            # ... other variables\n        }","type":"content","url":"/appendix-code#oracle-interface","position":9},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"Full Source"},"type":"lvl2","url":"/appendix-code#full-source","position":10},{"hierarchy":{"lvl1":"Appendix: Code Listings","lvl2":"Full Source"},"content":"Complete source code available at:\n\n\nhttps://​github​.com​/CosilicoAI​/cosilico​-engine​/tree​/main​/src​/cosilico","type":"content","url":"/appendix-code#full-source","position":11},{"hierarchy":{"lvl1":"Appendix: Provision Details"},"type":"lvl1","url":"/appendix-provisions","position":0},{"hierarchy":{"lvl1":"Appendix: Provision Details"},"content":"This appendix lists all provisions in the study with their statutory text, complexity scores, and encoding results.","type":"content","url":"/appendix-provisions","position":1},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl2":"Phase 1: Simple Provisions"},"type":"lvl2","url":"/appendix-provisions#phase-1-simple-provisions","position":2},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl2":"Phase 1: Simple Provisions"},"content":"","type":"content","url":"/appendix-provisions#phase-1-simple-provisions","position":3},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"1. EITC Phase-In (26 USC § 32(a)(1))","lvl2":"Phase 1: Simple Provisions"},"type":"lvl3","url":"/appendix-provisions#id-1-eitc-phase-in-26-usc-32-a-1","position":4},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"1. EITC Phase-In (26 USC § 32(a)(1))","lvl2":"Phase 1: Simple Provisions"},"content":"Complexity Score: 2\n\nConditionals: 0\n\nParameters: 2 (phase_in_rate, earned_income_amount)\n\nReferences: 1 (earned_income)\n\nNesting: 0\n\nStatutory Text:\n\nIn the case of an eligible individual, there shall be allowed as a credit against the tax imposed by this subtitle for the taxable year an amount equal to the credit percentage of so much of the taxpayer’s earned income for the taxable year as does not exceed the earned income amount.\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-1-eitc-phase-in-26-usc-32-a-1","position":5},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"2. Standard Deduction (26 USC § 63(c))","lvl2":"Phase 1: Simple Provisions"},"type":"lvl3","url":"/appendix-provisions#id-2-standard-deduction-26-usc-63-c","position":6},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"2. Standard Deduction (26 USC § 63(c))","lvl2":"Phase 1: Simple Provisions"},"content":"Complexity Score: 3\n\nConditionals: 1 (filing status switch)\n\nParameters: 4 (amounts by filing status)\n\nReferences: 0\n\nNesting: 0\n\nStatutory Text:\n\nFor purposes of this subtitle, the term “standard deduction” means the sum of—\n(A) the basic standard deduction, and\n(B) the additional standard deduction.\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-2-standard-deduction-26-usc-63-c","position":7},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"3. Child Tax Credit Base (26 USC § 24(a))","lvl2":"Phase 1: Simple Provisions"},"type":"lvl3","url":"/appendix-provisions#id-3-child-tax-credit-base-26-usc-24-a","position":8},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"3. Child Tax Credit Base (26 USC § 24(a))","lvl2":"Phase 1: Simple Provisions"},"content":"Complexity Score: 2\n\nConditionals: 0\n\nParameters: 1 (credit amount)\n\nReferences: 1 (qualifying children)\n\nNesting: 0\n\nStatutory Text:\n\nThere shall be allowed as a credit against the tax imposed by this chapter for the taxable year with respect to each qualifying child of the taxpayer for which the taxpayer is allowed a deduction under section 151 an amount equal to $1,000.\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-3-child-tax-credit-base-26-usc-24-a","position":9},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"4. Personal Exemption (26 USC § 151) [Historical]","lvl2":"Phase 1: Simple Provisions"},"type":"lvl3","url":"/appendix-provisions#id-4-personal-exemption-26-usc-151-historical","position":10},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"4. Personal Exemption (26 USC § 151) [Historical]","lvl2":"Phase 1: Simple Provisions"},"content":"Complexity Score: 2\n\nConditionals: 0\n\nParameters: 1 (exemption amount)\n\nReferences: 1 (dependents)\n\nNesting: 0\n\nStatutory Text:\n\nIn the case of an individual, the exemptions provided by this section shall be allowed as deductions in computing taxable income.\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-4-personal-exemption-26-usc-151-historical","position":11},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"5. SALT Deduction Cap (26 USC § 164(b)(6))","lvl2":"Phase 1: Simple Provisions"},"type":"lvl3","url":"/appendix-provisions#id-5-salt-deduction-cap-26-usc-164-b-6","position":12},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"5. SALT Deduction Cap (26 USC § 164(b)(6))","lvl2":"Phase 1: Simple Provisions"},"content":"Complexity Score: 2\n\nConditionals: 0\n\nParameters: 1 (cap amount)\n\nReferences: 1 (state_and_local_taxes)\n\nNesting: 0\n\nStatutory Text:\n\nIn the case of an individual, the aggregate amount of taxes taken into account under paragraphs (1), (2), and (3) of subsection (a) and paragraph (5) of this subsection for any taxable year shall not exceed $10,000.\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-5-salt-deduction-cap-26-usc-164-b-6","position":13},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl2":"Phase 2: Medium Provisions"},"type":"lvl2","url":"/appendix-provisions#phase-2-medium-provisions","position":14},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl2":"Phase 2: Medium Provisions"},"content":"","type":"content","url":"/appendix-provisions#phase-2-medium-provisions","position":15},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"6. Full EITC (26 USC § 32)","lvl2":"Phase 2: Medium Provisions"},"type":"lvl3","url":"/appendix-provisions#id-6-full-eitc-26-usc-32","position":16},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"6. Full EITC (26 USC § 32)","lvl2":"Phase 2: Medium Provisions"},"content":"Complexity Score: 6\n\nConditionals: 3 (phase-in, plateau, phase-out)\n\nParameters: 6 (rates, amounts, thresholds)\n\nReferences: 2 (earned_income, AGI)\n\nNesting: 0\n\nResult: 100% accuracy, 6 iterations (preliminary)","type":"content","url":"/appendix-provisions#id-6-full-eitc-26-usc-32","position":17},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"7. Child and Dependent Care Credit (26 USC § 21)","lvl2":"Phase 2: Medium Provisions"},"type":"lvl3","url":"/appendix-provisions#id-7-child-and-dependent-care-credit-26-usc-21","position":18},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"7. Child and Dependent Care Credit (26 USC § 21)","lvl2":"Phase 2: Medium Provisions"},"content":"Complexity Score: 5\n\nConditionals: 2 (AGI brackets, expense limits)\n\nParameters: 4 (rates, limits)\n\nReferences: 2 (AGI, care expenses)\n\nNesting: 0\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-7-child-and-dependent-care-credit-26-usc-21","position":19},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"8. Premium Tax Credit (26 USC § 36B)","lvl2":"Phase 2: Medium Provisions"},"type":"lvl3","url":"/appendix-provisions#id-8-premium-tax-credit-26-usc-36b","position":20},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"8. Premium Tax Credit (26 USC § 36B)","lvl2":"Phase 2: Medium Provisions"},"content":"Complexity Score: 6\n\nConditionals: 2 (income eligibility, subsidy phase-out)\n\nParameters: 5 (FPL thresholds, applicable percentages)\n\nReferences: 3 (household income, SLCSP, enrollment)\n\nNesting: 0\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-8-premium-tax-credit-26-usc-36b","position":21},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"9. Saver’s Credit (26 USC § 25B)","lvl2":"Phase 2: Medium Provisions"},"type":"lvl3","url":"/appendix-provisions#id-9-savers-credit-26-usc-25b","position":22},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"9. Saver’s Credit (26 USC § 25B)","lvl2":"Phase 2: Medium Provisions"},"content":"Complexity Score: 4\n\nConditionals: 1 (income brackets)\n\nParameters: 3 (credit rates by AGI)\n\nReferences: 2 (AGI, retirement contributions)\n\nNesting: 0\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-9-savers-credit-26-usc-25b","position":23},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"10. Adoption Credit (26 USC § 23)","lvl2":"Phase 2: Medium Provisions"},"type":"lvl3","url":"/appendix-provisions#id-10-adoption-credit-26-usc-23","position":24},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"10. Adoption Credit (26 USC § 23)","lvl2":"Phase 2: Medium Provisions"},"content":"Complexity Score: 5\n\nConditionals: 2 (domestic vs. foreign, phase-out)\n\nParameters: 4 (max credit, phase-out thresholds)\n\nReferences: 2 (qualified expenses, AGI)\n\nNesting: 0\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-10-adoption-credit-26-usc-23","position":25},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl2":"Phase 3: Complex Provisions"},"type":"lvl2","url":"/appendix-provisions#phase-3-complex-provisions","position":26},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl2":"Phase 3: Complex Provisions"},"content":"","type":"content","url":"/appendix-provisions#phase-3-complex-provisions","position":27},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"11. Alternative Minimum Tax (26 USC § 55-59)","lvl2":"Phase 3: Complex Provisions"},"type":"lvl3","url":"/appendix-provisions#id-11-alternative-minimum-tax-26-usc-55-59","position":28},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"11. Alternative Minimum Tax (26 USC § 55-59)","lvl2":"Phase 3: Complex Provisions"},"content":"Complexity Score: 12\n\nConditionals: 5+ (exemption phase-out, rate brackets, preferences)\n\nParameters: 8+ (exemption, phase-out, rates)\n\nReferences: 5+ (regular tax, itemized deductions, etc.)\n\nNesting: 2\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-11-alternative-minimum-tax-26-usc-55-59","position":29},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"12. Net Investment Income Tax (26 USC § 1411)","lvl2":"Phase 3: Complex Provisions"},"type":"lvl3","url":"/appendix-provisions#id-12-net-investment-income-tax-26-usc-1411","position":30},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"12. Net Investment Income Tax (26 USC § 1411)","lvl2":"Phase 3: Complex Provisions"},"content":"Complexity Score: 7\n\nConditionals: 2 (threshold by filing status, income type)\n\nParameters: 3 (rate, thresholds)\n\nReferences: 4 (NII, MAGI, threshold)\n\nNesting: 1\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-12-net-investment-income-tax-26-usc-1411","position":31},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"13. Social Security Benefit Taxation (26 USC § 86)","lvl2":"Phase 3: Complex Provisions"},"type":"lvl3","url":"/appendix-provisions#id-13-social-security-benefit-taxation-26-usc-86","position":32},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"13. Social Security Benefit Taxation (26 USC § 86)","lvl2":"Phase 3: Complex Provisions"},"content":"Complexity Score: 8\n\nConditionals: 3 (0%, 50%, 85% inclusion tiers)\n\nParameters: 4 (base amounts by filing status)\n\nReferences: 3 (benefits, combined income)\n\nNesting: 1\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-13-social-security-benefit-taxation-26-usc-86","position":33},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"14. Qualified Business Income Deduction (26 USC § 199A)","lvl2":"Phase 3: Complex Provisions"},"type":"lvl3","url":"/appendix-provisions#id-14-qualified-business-income-deduction-26-usc-199a","position":34},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"14. Qualified Business Income Deduction (26 USC § 199A)","lvl2":"Phase 3: Complex Provisions"},"content":"Complexity Score: 10\n\nConditionals: 4+ (SSTB rules, wage/basis limits, phase-outs)\n\nParameters: 6+ (thresholds, limits)\n\nReferences: 4+ (QBI, W-2 wages, UBIA)\n\nNesting: 2\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-14-qualified-business-income-deduction-26-usc-199a","position":35},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"15. Foreign Tax Credit (26 USC § 27)","lvl2":"Phase 3: Complex Provisions"},"type":"lvl3","url":"/appendix-provisions#id-15-foreign-tax-credit-26-usc-27","position":36},{"hierarchy":{"lvl1":"Appendix: Provision Details","lvl3":"15. Foreign Tax Credit (26 USC § 27)","lvl2":"Phase 3: Complex Provisions"},"content":"Complexity Score: 9\n\nConditionals: 3 (limitation categories, carryover)\n\nParameters: 5 (limits, baskets)\n\nReferences: 5 (foreign taxes, foreign income, total income)\n\nNesting: 1\n\nResult: TBD","type":"content","url":"/appendix-provisions#id-15-foreign-tax-credit-26-usc-27","position":37},{"hierarchy":{"lvl1":"Conclusion"},"type":"lvl1","url":"/conclusion","position":0},{"hierarchy":{"lvl1":"Conclusion"},"content":"We presented an AI system for automated rules-as-code encoding using reinforcement learning from implementation feedback. By using existing implementations (PolicyEngine, TAXSIM) as oracles, we create a closed-loop training signal that guides LLMs toward correct statutory encodings.","type":"content","url":"/conclusion","position":1},{"hierarchy":{"lvl1":"Conclusion","lvl2":"Summary of Contributions"},"type":"lvl2","url":"/conclusion#summary-of-contributions","position":2},{"hierarchy":{"lvl1":"Conclusion","lvl2":"Summary of Contributions"},"content":"Technical system: An agentic loop using Claude with tool use that iteratively generates and tests code until accuracy thresholds are met.\n\nEmpirical evaluation: Preregistered study on 15 IRC provisions demonstrating feasibility, cost-effectiveness, and transfer learning.\n\nFailure taxonomy: Categorization of systematic failures informing human oversight requirements.","type":"content","url":"/conclusion#summary-of-contributions","position":3},{"hierarchy":{"lvl1":"Conclusion","lvl2":"Key Takeaways"},"type":"lvl2","url":"/conclusion#key-takeaways","position":4},{"hierarchy":{"lvl1":"Conclusion","lvl2":"Key Takeaways"},"content":"AI can read law and write code: With the right feedback loop, LLMs achieve high accuracy on real statutory provisions.\n\nCost is low: Encoding costs cents to dollars per provision, potentially orders of magnitude cheaper than manual encoding.\n\nHumans remain essential: For ambiguous statute, novel legislation, and edge cases, human judgment is irreplaceable.\n\nOracles are the constraint: Where reference implementations exist, AI encoding works well; where they don’t, new approaches are needed.","type":"content","url":"/conclusion#key-takeaways","position":5},{"hierarchy":{"lvl1":"Conclusion","lvl2":"Vision"},"type":"lvl2","url":"/conclusion#vision","position":6},{"hierarchy":{"lvl1":"Conclusion","lvl2":"Vision"},"content":"We see AI-driven encoding as the foundation for computational law at scale. Rather than manually encoding each provision, AI does the heavy lifting while humans provide oversight and handle edge cases.\n\nThis shifts the bottleneck from implementation to validation—a more tractable problem when the AI’s work is auditable and testable.","type":"content","url":"/conclusion#vision","position":7},{"hierarchy":{"lvl1":"Conclusion","lvl2":"Code and Data"},"type":"lvl2","url":"/conclusion#code-and-data","position":8},{"hierarchy":{"lvl1":"Conclusion","lvl2":"Code and Data"},"content":"All code, data, and analysis available at:\n\nRepository: \n\nhttps://​github​.com​/CosilicoAI​/cosilico​-engine\n\nDocumentation: \n\nhttps://docs.rac.ai\n\nPaper: \n\nhttps://​docs​.rac​.ai​/paper","type":"content","url":"/conclusion#code-and-data","position":9},{"hierarchy":{"lvl1":"Discussion"},"type":"lvl1","url":"/discussion","position":0},{"hierarchy":{"lvl1":"Discussion"},"content":"","type":"content","url":"/discussion","position":1},{"hierarchy":{"lvl1":"Discussion","lvl2":"Key Findings"},"type":"lvl2","url":"/discussion#key-findings","position":2},{"hierarchy":{"lvl1":"Discussion","lvl2":"Key Findings"},"content":"","type":"content","url":"/discussion#key-findings","position":3},{"hierarchy":{"lvl1":"Discussion","lvl3":"AI Can Encode Tax Law","lvl2":"Key Findings"},"type":"lvl3","url":"/discussion#ai-can-encode-tax-law","position":4},{"hierarchy":{"lvl1":"Discussion","lvl3":"AI Can Encode Tax Law","lvl2":"Key Findings"},"content":"Our preliminary results demonstrate that LLMs can successfully encode statutory provisions into executable code. The EITC phase-in was encoded correctly on the first attempt, and the full EITC (including phase-out) achieved 100% accuracy after 6 iterations.\n\nThis suggests that for well-defined provisions with clear formulas, AI encoding is not only possible but efficient—costing cents rather than hours of expert time.","type":"content","url":"/discussion#ai-can-encode-tax-law","position":5},{"hierarchy":{"lvl1":"Discussion","lvl3":"Iteration Is Key","lvl2":"Key Findings"},"type":"lvl3","url":"/discussion#iteration-is-key","position":6},{"hierarchy":{"lvl1":"Discussion","lvl3":"Iteration Is Key","lvl2":"Key Findings"},"content":"The full EITC example illustrates the importance of the feedback loop. Initial attempts failed due to syntax errors and incomplete logic. Each iteration provided structured feedback (accuracy, specific failures) that guided the model toward a correct solution.\n\nThis is the core of RLIF: the oracle provides a training signal that the model can learn from without human intervention.","type":"content","url":"/discussion#iteration-is-key","position":7},{"hierarchy":{"lvl1":"Discussion","lvl3":"Complexity Matters","lvl2":"Key Findings"},"type":"lvl3","url":"/discussion#complexity-matters","position":8},{"hierarchy":{"lvl1":"Discussion","lvl3":"Complexity Matters","lvl2":"Key Findings"},"content":"We expect (and preliminary data suggests) that complexity correlates with iterations required. Simple provisions converge quickly; complex ones may require more attempts or fail entirely.\n\nThe complexity score we defined—counting conditionals, parameters, and references—appears to be a useful predictor. This has practical implications: we can estimate encoding difficulty before starting.","type":"content","url":"/discussion#complexity-matters","position":9},{"hierarchy":{"lvl1":"Discussion","lvl2":"Implications for Rules-as-Code"},"type":"lvl2","url":"/discussion#implications-for-rules-as-code","position":10},{"hierarchy":{"lvl1":"Discussion","lvl2":"Implications for Rules-as-Code"},"content":"","type":"content","url":"/discussion#implications-for-rules-as-code","position":11},{"hierarchy":{"lvl1":"Discussion","lvl3":"Scaling Potential","lvl2":"Implications for Rules-as-Code"},"type":"lvl3","url":"/discussion#scaling-potential","position":12},{"hierarchy":{"lvl1":"Discussion","lvl3":"Scaling Potential","lvl2":"Implications for Rules-as-Code"},"content":"If AI can encode provisions at 0.50-5 each, the economics of RaC change dramatically. The full U.S. tax code could theoretically be encoded for thousands rather than millions of dollars.\n\nMore importantly, AI encoding can scale with legislation. As new laws pass, the same system can encode them—potentially faster if transfer learning holds.","type":"content","url":"/discussion#scaling-potential","position":13},{"hierarchy":{"lvl1":"Discussion","lvl3":"Human Oversight Model","lvl2":"Implications for Rules-as-Code"},"type":"lvl3","url":"/discussion#human-oversight-model","position":14},{"hierarchy":{"lvl1":"Discussion","lvl3":"Human Oversight Model","lvl2":"Implications for Rules-as-Code"},"content":"Our failure mode analysis will inform where humans are most needed:\n\nAmbiguous statute: Legal interpretation beyond AI capability\n\nMissing oracle: New provisions with no reference implementation\n\nOracle disagreement: Conflicting implementations require judgment\n\nEdge cases: Unusual scenarios not covered by test cases\n\nThis suggests a human-in-the-loop model where AI handles routine encoding and humans focus on judgment calls.","type":"content","url":"/discussion#human-oversight-model","position":15},{"hierarchy":{"lvl1":"Discussion","lvl3":"Oracle Dependency","lvl2":"Implications for Rules-as-Code"},"type":"lvl3","url":"/discussion#oracle-dependency","position":16},{"hierarchy":{"lvl1":"Discussion","lvl3":"Oracle Dependency","lvl2":"Implications for Rules-as-Code"},"content":"A key limitation: our approach requires oracles. For novel legislation, no oracle exists. We hypothesize that transfer learning will help—the model learns statutory patterns that generalize—but this requires further study.","type":"content","url":"/discussion#oracle-dependency","position":17},{"hierarchy":{"lvl1":"Discussion","lvl2":"Limitations"},"type":"lvl2","url":"/discussion#limitations","position":18},{"hierarchy":{"lvl1":"Discussion","lvl2":"Limitations"},"content":"Oracle quality: Our accuracy is bounded by oracle accuracy\n\nDSL constraints: Complex logic may not fit our DSL\n\nSingle model: Results may not generalize to other LLMs\n\nSmall sample: 15 provisions is exploratory, not definitive\n\nTax-specific: Other legal domains may differ","type":"content","url":"/discussion#limitations","position":19},{"hierarchy":{"lvl1":"Discussion","lvl2":"Future Work"},"type":"lvl2","url":"/discussion#future-work","position":20},{"hierarchy":{"lvl1":"Discussion","lvl2":"Future Work"},"content":"Expand provisions: Test on hundreds of provisions across tax, benefits, regulations\n\nFine-tuning: Does training on successful encodings improve performance?\n\nOracle-free: Can AI encode from statute alone, with human validation?\n\nMulti-jurisdiction: Does transfer learning work across countries?\n\nReal-time encoding: Encode bills as they’re drafted, before passage","type":"content","url":"/discussion#future-work","position":21},{"hierarchy":{"lvl1":"AI-Driven Rules-as-Code Encoding"},"type":"lvl1","url":"/","position":0},{"hierarchy":{"lvl1":"AI-Driven Rules-as-Code Encoding"},"content":"Reinforcement Learning from Implementation Feedback for Automated Statutory Encoding\n\nCosilico AI | December 2024","type":"content","url":"/","position":1},{"hierarchy":{"lvl1":"AI-Driven Rules-as-Code Encoding","lvl2":"Abstract"},"type":"lvl2","url":"/#abstract","position":2},{"hierarchy":{"lvl1":"AI-Driven Rules-as-Code Encoding","lvl2":"Abstract"},"content":"We demonstrate that large language models can automatically encode statutory provisions into executable code by using existing implementations as oracles for reinforcement learning. Our agentic loop achieves 95%+ accuracy on tax provisions ranging from simple formulas to complex multi-branch calculations, with costs under $1 per provision. We find evidence of transfer learning—provisions encoded later require fewer iterations—and identify systematic failure modes that inform human oversight requirements.","type":"content","url":"/#abstract","position":3},{"hierarchy":{"lvl1":"AI-Driven Rules-as-Code Encoding","lvl2":"Quick Links"},"type":"lvl2","url":"/#quick-links","position":4},{"hierarchy":{"lvl1":"AI-Driven Rules-as-Code Encoding","lvl2":"Quick Links"},"content":"Preregistration: Hypotheses and methods specified before data collection\n\nResults: Empirical findings\n\nCode: Full implementation","type":"content","url":"/#quick-links","position":5},{"hierarchy":{"lvl1":"AI-Driven Rules-as-Code Encoding","lvl2":"Citation"},"type":"lvl2","url":"/#citation","position":6},{"hierarchy":{"lvl1":"AI-Driven Rules-as-Code Encoding","lvl2":"Citation"},"content":"@article{cosilico2024airules,\n  title={AI-Driven Rules-as-Code Encoding: Reinforcement Learning from Implementation Feedback},\n  author={Cosilico AI},\n  year={2024},\n  url={https://docs.rac.ai/paper}\n}","type":"content","url":"/#citation","position":7},{"hierarchy":{"lvl1":"Introduction"},"type":"lvl1","url":"/introduction","position":0},{"hierarchy":{"lvl1":"Introduction"},"content":"","type":"content","url":"/introduction","position":1},{"hierarchy":{"lvl1":"Introduction","lvl2":"The Rules-as-Code Challenge"},"type":"lvl2","url":"/introduction#the-rules-as-code-challenge","position":2},{"hierarchy":{"lvl1":"Introduction","lvl2":"The Rules-as-Code Challenge"},"content":"Legislation governs trillions of dollars in tax collection and benefit distribution, yet remains encoded primarily in natural language. Converting statutes to executable code—rules-as-code (RaC)—enables:\n\nSimulation: Model policy changes before enactment\n\nAutomation: Streamline benefit delivery and tax filing\n\nTransparency: Make calculations auditable and reproducible\n\nAccessibility: Let citizens understand how rules affect them\n\nBut encoding is expensive. A single tax provision can take days of expert effort, and the full U.S. tax code contains thousands of interacting rules. Organizations like PolicyEngine and NBER’s TAXSIM have encoded major provisions, but coverage remains incomplete and maintenance is ongoing.","type":"content","url":"/introduction#the-rules-as-code-challenge","position":3},{"hierarchy":{"lvl1":"Introduction","lvl2":"AI as Encoder"},"type":"lvl2","url":"/introduction#ai-as-encoder","position":4},{"hierarchy":{"lvl1":"Introduction","lvl2":"AI as Encoder"},"content":"Recent advances in large language models (LLMs) suggest a different approach: rather than humans reading statute and writing code, have AI do both. The key insight is that existing implementations can serve as oracles—ground truth for training.\n\nThis is analogous to reinforcement learning from human feedback (RLHF), but with deterministic feedback from code execution:\n\nAI reads statutory text\n\nAI generates code\n\nCode runs against test cases derived from oracles\n\nAccuracy signal trains the AI to improve\n\nWe call this reinforcement learning from implementation feedback (RLIF).","type":"content","url":"/introduction#ai-as-encoder","position":5},{"hierarchy":{"lvl1":"Introduction","lvl2":"Contributions"},"type":"lvl2","url":"/introduction#contributions","position":6},{"hierarchy":{"lvl1":"Introduction","lvl2":"Contributions"},"content":"This paper makes three contributions:\n\nSystem: We implement an agentic loop that encodes statutory provisions using Claude with tool use, achieving high accuracy on real tax provisions.\n\nEmpirical evaluation: We test on 15 IRC provisions with preregistered hypotheses, measuring convergence rates, costs, and transfer learning effects.\n\nFailure analysis: We categorize systematic failure modes, informing where human oversight is most needed.","type":"content","url":"/introduction#contributions","position":7},{"hierarchy":{"lvl1":"Introduction","lvl2":"Roadmap"},"type":"lvl2","url":"/introduction#roadmap","position":8},{"hierarchy":{"lvl1":"Introduction","lvl2":"Roadmap"},"content":"Methods: System architecture, provision selection, metrics\n\nResults: Accuracy, cost, transfer learning, failure modes\n\nDiscussion: Implications for RaC, limitations, future work\n\nAppendices: Full preregistration, provision details, code listings","type":"content","url":"/introduction#roadmap","position":9},{"hierarchy":{"lvl1":"Methods"},"type":"lvl1","url":"/methods","position":0},{"hierarchy":{"lvl1":"Methods"},"content":"","type":"content","url":"/methods","position":1},{"hierarchy":{"lvl1":"Methods","lvl2":"System Architecture"},"type":"lvl2","url":"/methods#system-architecture","position":2},{"hierarchy":{"lvl1":"Methods","lvl2":"System Architecture"},"content":"Our system comprises five components:┌─────────────┐     ┌─────────────┐     ┌─────────────┐\n│   Statute   │────▶│   Claude    │────▶│  Generated  │\n│    Text     │     │   Agent     │     │    Code     │\n└─────────────┘     └──────┬──────┘     └──────┬──────┘\n                           │                    │\n                           │    ┌───────────────┘\n                           │    │\n                    ┌──────▼────▼──────┐\n                    │     Executor     │\n                    │   (DSL Parser)   │\n                    └────────┬─────────┘\n                             │\n                    ┌────────▼─────────┐\n                    │   Test Cases     │\n                    │  (from Oracles)  │\n                    └────────┬─────────┘\n                             │\n                    ┌────────▼─────────┐\n                    │     Scorer       │\n                    │  (Accuracy, MAE) │\n                    └────────┬─────────┘\n                             │\n                    ┌────────▼─────────┐\n                    │    Diagnoser     │──────▶ Feedback to Agent\n                    │ (Failure Analysis)│\n                    └──────────────────┘","type":"content","url":"/methods#system-architecture","position":3},{"hierarchy":{"lvl1":"Methods","lvl3":"Claude Agent","lvl2":"System Architecture"},"type":"lvl3","url":"/methods#claude-agent","position":4},{"hierarchy":{"lvl1":"Methods","lvl3":"Claude Agent","lvl2":"System Architecture"},"content":"We use Claude Sonnet 4 with tool use. The agent has access to two tools:\n\nexecute_dsl: Runs generated code against test cases, returns accuracy and failure details\n\nsubmit_final_code: Signals completion with final implementation\n\nThe system prompt provides:\n\nDSL specification (entity types, formula syntax, reference format)\n\nAvailable parameters (rates, thresholds from IRS publications)\n\nInstructions for iteration","type":"content","url":"/methods#claude-agent","position":5},{"hierarchy":{"lvl1":"Methods","lvl3":"Domain-Specific Language","lvl2":"System Architecture"},"type":"lvl3","url":"/methods#domain-specific-language","position":6},{"hierarchy":{"lvl1":"Methods","lvl3":"Domain-Specific Language","lvl2":"System Architecture"},"content":"Our Cosilico DSL captures:\n\nVariables: Named calculations with entity scope (Person, TaxUnit, Household)\n\nFormulas: Arithmetic expressions with conditionals and functions\n\nReferences: Pointers to other variables and parameters\n\nCitations: Links to statutory sections\n\nExample:variable eitc_phase_in_credit:\n  entity: TaxUnit\n  period: Year\n  dtype: Money\n  citation: \"26 USC § 32(a)(1)\"\n\n  references:\n    earned_income: us/irs/income/earned_income\n    phase_in_rate: param.irs.eitc.phase_in_rate\n\n  formula:\n    min(earned_income, earned_income_amount) * phase_in_rate","type":"content","url":"/methods#domain-specific-language","position":7},{"hierarchy":{"lvl1":"Methods","lvl3":"Oracles (Blackbox Only)","lvl2":"System Architecture"},"type":"lvl3","url":"/methods#oracles-blackbox-only","position":8},{"hierarchy":{"lvl1":"Methods","lvl3":"Oracles (Blackbox Only)","lvl2":"System Architecture"},"content":"Critically, the agent has no access to oracle source code—only output comparisons. This prevents trivial copying and ensures the agent must learn statutory logic from the text itself.\n\nPolicyEngine-US serves as primary oracle:\n\nComprehensive federal tax implementation\n\nValidated against IRS examples\n\nAPI access for automated testing\n\nAgent sees only: (input, expected_output) pairs\n\nTAXSIM (NBER) provides secondary validation:\n\nIndependent implementation\n\nFlags disagreements for investigation\n\nCross-oracle agreement increases confidence","type":"content","url":"/methods#oracles-blackbox-only","position":9},{"hierarchy":{"lvl1":"Methods","lvl3":"Hard Constraints vs. Soft Rewards","lvl2":"System Architecture"},"type":"lvl3","url":"/methods#hard-constraints-vs-soft-rewards","position":10},{"hierarchy":{"lvl1":"Methods","lvl3":"Hard Constraints vs. Soft Rewards","lvl2":"System Architecture"},"content":"We distinguish between hard constraints (binary pass/fail) and soft rewards (continuous optimization targets):\n\nHard Constraints (must pass, not in reward function):\n\nConstraint\n\nEnforcement\n\nRationale\n\nNo hardcoded values\n\nCI linter: only 0, 1, -1 allowed in formulas\n\nForces parameterization\n\nInline tests pass\n\nDSL executor validates\n\nCatches syntax and basic logic errors\n\nValid DSL syntax\n\nParser rejects invalid code\n\nAgent must produce parseable output\n\nEntity/period consistency\n\nType checker\n\nPrevents dimensional errors\n\nSoft Rewards (continuous, optimized via RL):\n\nReward Component\n\nWeight\n\nMetric\n\nOracle alignment\n\n0.60\n\n1 - MAE/max_value across test cases\n\nToken efficiency\n\n0.15\n\n1 - (tokens_used / max_tokens)\n\nPerformance\n\n0.15\n\nLog-scale execution time (vectorized)\n\nGeneralization\n\n0.10\n\nHoldout accuracy on unseen cases\n\nToken efficiency rewards concise encodings and fast convergence—fewer iterations = fewer tokens = higher reward.\n\nThis separation ensures that failing a hard constraint is not a “low reward” but a rejection—the agent must retry until constraints pass. The soft rewards then guide toward optimal solutions among valid candidates.","type":"content","url":"/methods#hard-constraints-vs-soft-rewards","position":11},{"hierarchy":{"lvl1":"Methods","lvl3":"Hyperparameters","lvl2":"System Architecture"},"type":"lvl3","url":"/methods#hyperparameters","position":12},{"hierarchy":{"lvl1":"Methods","lvl3":"Hyperparameters","lvl2":"System Architecture"},"content":"Beyond model choice, key hyperparameters affect convergence:\n\nParameter\n\nDefault\n\nDescription\n\nMax iterations\n\n10\n\nHard cap on encode-validate cycles\n\nTarget accuracy\n\n0.95\n\nEarly stop if achieved\n\nBatch size\n\n50\n\nTest cases per validation round\n\nFeedback limit\n\n10\n\nMax failing cases shown to agent\n\nTemperature\n\n0.0\n\nDeterministic generation\n\nBatch size trades off signal vs. cost: larger batches catch more errors per iteration but increase API calls. We found 50 cases per round balances convergence speed with cost, increasing to 200 for aggregate microsim validation.\n\nFeedback limit prevents prompt overflow—showing 10 representative failures is sufficient for diagnosis.","type":"content","url":"/methods#hyperparameters","position":13},{"hierarchy":{"lvl1":"Methods","lvl3":"Test Case Generation","lvl2":"System Architecture"},"type":"lvl3","url":"/methods#test-case-generation","position":14},{"hierarchy":{"lvl1":"Methods","lvl3":"Test Case Generation","lvl2":"System Architecture"},"content":"For each provision, we generate test cases covering:\n\nIncome distribution (log-uniform from 0 to 1M)\n\nFamily structures (0-4 children, various filing statuses)\n\nBoundary values (exactly at thresholds)\n\nEdge cases (zero income, maximum values)\n\nTypical test suite: 100-500 cases per provision.","type":"content","url":"/methods#test-case-generation","position":15},{"hierarchy":{"lvl1":"Methods","lvl2":"Pilot Phase Learnings"},"type":"lvl2","url":"/methods#pilot-phase-learnings","position":16},{"hierarchy":{"lvl1":"Methods","lvl2":"Pilot Phase Learnings"},"content":"Before the formal experiment, we conducted pilot encoding runs on select provisions to validate our infrastructure and refine the experimental design. These runs are not included in the main results but informed key methodological choices.","type":"content","url":"/methods#pilot-phase-learnings","position":17},{"hierarchy":{"lvl1":"Methods","lvl3":"Key Discovery: Phase-In vs Phase-Out Rate Confusion","lvl2":"Pilot Phase Learnings"},"type":"lvl3","url":"/methods#key-discovery-phase-in-vs-phase-out-rate-confusion","position":18},{"hierarchy":{"lvl1":"Methods","lvl3":"Key Discovery: Phase-In vs Phase-Out Rate Confusion","lvl2":"Pilot Phase Learnings"},"content":"During pilot encoding of the Earned Income Tax Credit, we discovered a subtle bug pattern. The EITC has different rates for phase-in (34% for 1 child) and phase-out (15.98% for 1 child), but the agent initially used the phase-out rate for both regions—producing a systematic $9.2B aggregate underestimate vs PolicyEngine.\n\nThis error was only caught by record-by-record comparison across the full CPS microdata (200K+ records), not by unit test cases. The fix was straightforward once identified:- phase_in_credit = earned_income * phaseout_rate  # WRONG\n+ phase_in_credit = earned_income * phase_in_rate  # CORRECT\n\nImplications for experiment design:\n\nValidation must include aggregate microsimulation, not just unit tests\n\nParameters with similar names (phase_in_rate vs phaseout_rate) are high-confusion risk\n\nThe agent benefits from explicit rate derivation checks in feedback","type":"content","url":"/methods#key-discovery-phase-in-vs-phase-out-rate-confusion","position":19},{"hierarchy":{"lvl1":"Methods","lvl3":"Infrastructure Validated","lvl2":"Pilot Phase Learnings"},"type":"lvl3","url":"/methods#infrastructure-validated","position":20},{"hierarchy":{"lvl1":"Methods","lvl3":"Infrastructure Validated","lvl2":"Pilot Phase Learnings"},"content":"Encoder RL loop: Converged to 100% accuracy on standard deduction within 3 iterations\n\nValidator integration: PolicyEngine API successfully returns test case results\n\nNo-hardcodes linter: Correctly rejects formulas like if age >= 65 (must use parameters)\n\nExperiment tracking: Run metadata saved to optimization/runs/","type":"content","url":"/methods#infrastructure-validated","position":21},{"hierarchy":{"lvl1":"Methods","lvl2":"Provision Selection"},"type":"lvl2","url":"/methods#provision-selection","position":22},{"hierarchy":{"lvl1":"Methods","lvl2":"Provision Selection"},"content":"We encode 15 provisions from the Internal Revenue Code, stratified by complexity:\n\nPhase\n\nProvisions\n\nComplexity\n\nExamples\n\n1\n\n5\n\nSimple (1-3)\n\nEITC phase-in, Standard deduction\n\n2\n\n5\n\nMedium (4-6)\n\nFull EITC, Child care credit\n\n3\n\n5\n\nComplex (7+)\n\nAMT, NIIT, QBI deduction\n\nComplexity score = conditionals + parameters + references + 2×nesting","type":"content","url":"/methods#provision-selection","position":23},{"hierarchy":{"lvl1":"Methods","lvl2":"Metrics"},"type":"lvl2","url":"/methods#metrics","position":24},{"hierarchy":{"lvl1":"Methods","lvl2":"Metrics"},"content":"Primary:\n\nAccuracy: Proportion of test cases passing (within $1 tolerance)\n\nIterations: Generate-test cycles to reach 95%\n\nTokens: API usage (input + output)\n\nCost: Tokens × rate (3/M input, 15/M output for Sonnet)\n\nSecondary:\n\nTime to convergence\n\nError type distribution\n\nHuman interventions required","type":"content","url":"/methods#metrics","position":25},{"hierarchy":{"lvl1":"Methods","lvl2":"Analysis Plan"},"type":"lvl2","url":"/methods#analysis-plan","position":26},{"hierarchy":{"lvl1":"Methods","lvl2":"Analysis Plan"},"content":"All hypotheses preregistered (see Appendix A):\n\nH1 (Convergence): Bootstrap CI for convergence rate\n\nH2 (Complexity): Regression of iterations on complexity score\n\nH3 (Transfer): Paired comparison of early vs. late provisions\n\nH4 (Cost): Trend analysis and comparison to manual estimates\n\nH5 (Failures): Chi-square test for failure category distribution","type":"content","url":"/methods#analysis-plan","position":27},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding"},"type":"lvl1","url":"/preregistration","position":0},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding"},"content":"Study Title: Reinforcement Learning from Implementation Feedback for Automated Statutory Encoding\n\nAuthors: Cosilico AI\n\nDate: December 2024\n\nRegistration: This document serves as the preregistration for our empirical study on AI-driven rules-as-code encoding. The hypotheses, methods, and analysis plans below were specified before data collection.","type":"content","url":"/preregistration","position":1},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"1. Research Questions"},"type":"lvl2","url":"/preregistration#id-1-research-questions","position":2},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"1. Research Questions"},"content":"","type":"content","url":"/preregistration#id-1-research-questions","position":3},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"Primary Question","lvl2":"1. Research Questions"},"type":"lvl3","url":"/preregistration#primary-question","position":4},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"Primary Question","lvl2":"1. Research Questions"},"content":"Can large language models (LLMs) automatically encode statutory provisions into executable code by using existing implementations as oracles for reinforcement learning?","type":"content","url":"/preregistration#primary-question","position":5},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"Secondary Questions","lvl2":"1. Research Questions"},"type":"lvl3","url":"/preregistration#secondary-questions","position":6},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"Secondary Questions","lvl2":"1. Research Questions"},"content":"How does accuracy vary across provision complexity (simple formulas vs. multi-branch logic)?\n\nDoes transfer learning occur—do later provisions encode faster than earlier ones?\n\nWhat is the cost-effectiveness compared to manual encoding?\n\nWhere do LLMs systematically fail, and what human oversight is required?","type":"content","url":"/preregistration#secondary-questions","position":7},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"2. Hypotheses"},"type":"lvl2","url":"/preregistration#id-2-hypotheses","position":8},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"2. Hypotheses"},"content":"","type":"content","url":"/preregistration#id-2-hypotheses","position":9},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H1: Convergence Hypothesis","lvl2":"2. Hypotheses"},"type":"lvl3","url":"/preregistration#h1-convergence-hypothesis","position":10},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H1: Convergence Hypothesis","lvl2":"2. Hypotheses"},"content":"Statement: For well-defined statutory provisions with dense oracle coverage, the agentic loop will achieve ≥95% accuracy within 10 iterations.\n\nOperationalization:\n\n“Well-defined”: Provisions with explicit formulas or clear conditional logic (e.g., EITC phase-in, standard deduction)\n\n“Dense oracle coverage”: ≥100 test cases from PolicyEngine or TAXSIM\n\n“Accuracy”: Proportion of test cases where generated code output matches oracle output within $1\n\nExpected effect: 80% of well-defined provisions will converge within 10 iterations.","type":"content","url":"/preregistration#h1-convergence-hypothesis","position":11},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H2: Complexity Scaling Hypothesis","lvl2":"2. Hypotheses"},"type":"lvl3","url":"/preregistration#h2-complexity-scaling-hypothesis","position":12},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H2: Complexity Scaling Hypothesis","lvl2":"2. Hypotheses"},"content":"Statement: The number of iterations required scales with provision complexity, measured by:\n\nNumber of conditional branches\n\nNumber of parameters referenced\n\nDependency depth (how many other provisions it references)\n\nOperationalization:\n\nSimple (complexity score 1-3): ≤3 iterations to 95% accuracy\n\nMedium (complexity score 4-6): 4-7 iterations\n\nComplex (complexity score 7+): 8+ iterations or failure\n\nComplexity scoring:\n\n+1 per conditional branch\n\n+1 per parameter\n\n+1 per external reference\n\n+2 per nested conditional","type":"content","url":"/preregistration#h2-complexity-scaling-hypothesis","position":13},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H3: Transfer Learning Hypothesis","lvl2":"2. Hypotheses"},"type":"lvl3","url":"/preregistration#h3-transfer-learning-hypothesis","position":14},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H3: Transfer Learning Hypothesis","lvl2":"2. Hypotheses"},"content":"Statement: Encoding performance improves over the course of the study—provisions encoded later require fewer iterations than earlier provisions of similar complexity.\n\nOperationalization:\n\nCompare mean iterations for first 5 provisions vs. last 5 provisions (matched by complexity)\n\nExpect ≥20% reduction in iterations\n\nMechanism: Few-shot examples accumulate; model learns statutory patterns.","type":"content","url":"/preregistration#h3-transfer-learning-hypothesis","position":15},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H4: Cost Efficiency Hypothesis","lvl2":"2. Hypotheses"},"type":"lvl3","url":"/preregistration#h4-cost-efficiency-hypothesis","position":16},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H4: Cost Efficiency Hypothesis","lvl2":"2. Hypotheses"},"content":"Statement: The cost per provision (API tokens × rate) decreases over time and is competitive with estimated manual encoding costs.\n\nOperationalization:\n\nTrack total tokens (input + output) per provision\n\nEstimate manual cost at $100-500 per provision (based on engineer hours)\n\nExpect AI cost <10 per simple provision, <50 per complex provision","type":"content","url":"/preregistration#h4-cost-efficiency-hypothesis","position":17},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H5: Failure Mode Hypothesis","lvl2":"2. Hypotheses"},"type":"lvl3","url":"/preregistration#h5-failure-mode-hypothesis","position":18},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"H5: Failure Mode Hypothesis","lvl2":"2. Hypotheses"},"content":"Statement: Systematic failures will cluster around specific categories:\n\nAmbiguous statutory language\n\nMissing parameters in oracle\n\nOracle disagreements (PE vs. TAXSIM)\n\nTemporal logic (effective dates, phase-ins)\n\nOperationalization:\n\nCategorize all failures that don’t reach 90% accuracy\n\nExpect ≥50% of failures to fall into the above categories","type":"content","url":"/preregistration#h5-failure-mode-hypothesis","position":19},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"3. Methods"},"type":"lvl2","url":"/preregistration#id-3-methods","position":20},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"3. Methods"},"content":"","type":"content","url":"/preregistration#id-3-methods","position":21},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.1 Provisions to Encode","lvl2":"3. Methods"},"type":"lvl3","url":"/preregistration#id-3-1-provisions-to-encode","position":22},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.1 Provisions to Encode","lvl2":"3. Methods"},"content":"We will encode the following provisions from the Internal Revenue Code (IRC):\n\nPhase 1: Simple Provisions (complexity 1-3)\n\nEITC phase-in credit (26 USC § 32(a)(1))\n\nStandard deduction (26 USC § 63(c))\n\nChild tax credit base amount (26 USC § 24(a))\n\nPersonal exemption (26 USC § 151) [historical]\n\nSALT deduction cap (26 USC § 164(b)(6))\n\nPhase 2: Medium Provisions (complexity 4-6)\n6. Full EITC with phase-out (26 USC § 32)\n7. Child and dependent care credit (26 USC § 21)\n8. Premium tax credit (26 USC § 36B)\n9. Saver’s credit (26 USC § 25B)\n10. Adoption credit (26 USC § 23)\n\nPhase 3: Complex Provisions (complexity 7+)\n11. Alternative Minimum Tax (26 USC § 55-59)\n12. Net Investment Income Tax (26 USC § 1411)\n13. Social Security benefit taxation (26 USC § 86)\n14. Qualified business income deduction (26 USC § 199A)\n15. Foreign tax credit (26 USC § 27)","type":"content","url":"/preregistration#id-3-1-provisions-to-encode","position":23},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.2 Oracle Setup","lvl2":"3. Methods"},"type":"lvl3","url":"/preregistration#id-3-2-oracle-setup","position":24},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.2 Oracle Setup","lvl2":"3. Methods"},"content":"Primary Oracle: PolicyEngine-US (v1.x)\n\nProvides comprehensive federal tax calculations\n\nAPI access for automated testing\n\nBlackbox only: Agent sees (input, output) pairs, not source code\n\nSecondary Oracle: TAXSIM (NBER)\n\nIndependent validation\n\nUsed to flag disagreements\n\nValidation Levels (informed by pilot phase):\n\nUnit tests: Individual cases with known expected values\n\nAggregate microsimulation: Sum across CPS microdata must match within tolerance\n\nCross-oracle: PolicyEngine and TAXSIM agreement where coverage overlaps\n\nThe pilot phase revealed that aggregate validation is critical—unit tests may pass while systematic errors cause large aggregate gaps (e.g., $9.2B EITC underestimate from phase-in/phase-out rate confusion).\n\nTest Case Generation:\n\n100-500 test cases per provision\n\nStratified sampling across income levels, filing statuses, family sizes\n\nBoundary cases at phase-in/phase-out thresholds\n\nAdversarial cases designed to expose edge cases","type":"content","url":"/preregistration#id-3-2-oracle-setup","position":25},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.3 Agentic Loop Configuration","lvl2":"3. Methods"},"type":"lvl3","url":"/preregistration#id-3-3-agentic-loop-configuration","position":26},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.3 Agentic Loop Configuration","lvl2":"3. Methods"},"content":"Model: Claude Sonnet 4 (claude-sonnet-4-20250514)\nMax iterations: 10 per provision\nTarget accuracy: 95%\nTools available:\n\nexecute_dsl: Run code against test cases\n\nsubmit_final_code: Complete encoding\n\nHard Constraints (binary pass/fail, not part of reward):\n\nNo hardcoded numeric values in formulas (only 0, 1, -1 allowed)\n\nDSL syntax must parse successfully\n\nInline tests must pass\n\nEntity and period types must be consistent\n\nSoft Rewards (continuous, weighted):\n\nOracle alignment (60%): 1 - MAE/max_value\n\nToken efficiency (15%): 1 - tokens_used/max_tokens (rewards concise encodings)\n\nPerformance (15%): Log-scale vectorized execution time\n\nGeneralization (10%): Accuracy on holdout test cases\n\nPrompt structure:\n\nSystem prompt with DSL specification\n\nStatutory text (verbatim from USC)\n\nSample test cases (5 examples)\n\nParameter values (from IRS publications)","type":"content","url":"/preregistration#id-3-3-agentic-loop-configuration","position":27},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.4 Metrics","lvl2":"3. Methods"},"type":"lvl3","url":"/preregistration#id-3-4-metrics","position":28},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.4 Metrics","lvl2":"3. Methods"},"content":"Primary Metrics:\n\nAccuracy: % test cases passing (within $1 tolerance)\n\nIterations: Number of generate-test cycles\n\nTokens: Total input + output tokens\n\nCost: Tokens × rate (Sonnet: 3/M in, 15/M out)\n\nSecondary Metrics:\n\nTime to convergence (wall clock)\n\nError categories (syntax, runtime, value mismatch)\n\nHuman interventions required","type":"content","url":"/preregistration#id-3-4-metrics","position":29},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.5 Analysis Plan","lvl2":"3. Methods"},"type":"lvl3","url":"/preregistration#id-3-5-analysis-plan","position":30},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"3.5 Analysis Plan","lvl2":"3. Methods"},"content":"H1 Analysis:\n\nCalculate convergence rate (% provisions reaching 95% in ≤10 iterations)\n\n95% CI via bootstrap (1000 resamples)\n\nSuccess threshold: lower bound of CI > 60%\n\nH2 Analysis:\n\nFit regression: iterations ~ complexity_score\n\nExpect positive coefficient with p < 0.05\n\nR² threshold: > 0.3 indicates meaningful relationship\n\nH3 Analysis:\n\nPaired comparison: first 5 vs. last 5 provisions (matched complexity)\n\nWilcoxon signed-rank test\n\nEffect size: Cohen’s d\n\nH4 Analysis:\n\nPlot cost per provision over sequence\n\nFit exponential decay: cost_i = a * exp(-b*i) + c\n\nCompare to manual cost estimate ($100-500)\n\nH5 Analysis:\n\nCategorize failures manually\n\nChi-square test for non-uniform distribution across categories\n\nReport category proportions with 95% CI","type":"content","url":"/preregistration#id-3-5-analysis-plan","position":31},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"4. Data Collection Protocol"},"type":"lvl2","url":"/preregistration#id-4-data-collection-protocol","position":32},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"4. Data Collection Protocol"},"content":"","type":"content","url":"/preregistration#id-4-data-collection-protocol","position":33},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"4.1 Procedure","lvl2":"4. Data Collection Protocol"},"type":"lvl3","url":"/preregistration#id-4-1-procedure","position":34},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"4.1 Procedure","lvl2":"4. Data Collection Protocol"},"content":"For each provision in order (Phase 1 → Phase 2 → Phase 3):\na. Generate test cases from oracle\nb. Run agentic loop with logging\nc. Record all metrics\nd. If failure (no convergence), categorize failure mode\ne. Optional: manual fix and re-run with fix as context","type":"content","url":"/preregistration#id-4-1-procedure","position":35},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"4.2 Logging","lvl2":"4. Data Collection Protocol"},"type":"lvl3","url":"/preregistration#id-4-2-logging","position":36},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"4.2 Logging","lvl2":"4. Data Collection Protocol"},"content":"All runs will log:\n\nFull conversation history (prompts and responses)\n\nToken counts per turn\n\nTest results per iteration\n\nFinal code\n\nTimestamps\n\nLogs stored in: paper/data/runs/","type":"content","url":"/preregistration#id-4-2-logging","position":37},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"4.3 Stopping Rules","lvl2":"4. Data Collection Protocol"},"type":"lvl3","url":"/preregistration#id-4-3-stopping-rules","position":38},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"4.3 Stopping Rules","lvl2":"4. Data Collection Protocol"},"content":"Stop iteration if accuracy ≥95% (success)\n\nStop iteration if accuracy unchanged for 3 consecutive iterations (plateau)\n\nStop iteration at 10 iterations (max)\n\nStop study early if 5 consecutive complex provisions fail (systemic issue)","type":"content","url":"/preregistration#id-4-3-stopping-rules","position":39},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"5. Deviations and Amendments"},"type":"lvl2","url":"/preregistration#id-5-deviations-and-amendments","position":40},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"5. Deviations and Amendments"},"content":"Any deviations from this preregistration will be documented in:\npaper/amendments.md\n\nTypes of acceptable deviations:\n\nAdding provisions (extending scope)\n\nAdjusting complexity scores based on initial results\n\nBug fixes in tooling (not affecting results)\n\nTypes requiring justification:\n\nChanging target accuracy threshold\n\nChanging max iterations\n\nExcluding provisions post-hoc","type":"content","url":"/preregistration#id-5-deviations-and-amendments","position":41},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"6. Timeline"},"type":"lvl2","url":"/preregistration#id-6-timeline","position":42},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"6. Timeline"},"content":"Week 1: Phase 1 provisions (simple)\n\nWeek 2: Phase 2 provisions (medium)\n\nWeek 3: Phase 3 provisions (complex)\n\nWeek 4: Analysis and writeup","type":"content","url":"/preregistration#id-6-timeline","position":43},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"7. Code and Data Availability"},"type":"lvl2","url":"/preregistration#id-7-code-and-data-availability","position":44},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"7. Code and Data Availability"},"content":"All code, data, and analysis will be available at:\n\nRepository: \n\nhttps://​github​.com​/CosilicoAI​/cosilico​-engine\n\nPaper: \n\nhttps://​docs​.rac​.ai​/paper/","type":"content","url":"/preregistration#id-7-code-and-data-availability","position":45},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"Appendix A: Complexity Scoring Examples"},"type":"lvl2","url":"/preregistration#appendix-a-complexity-scoring-examples","position":46},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"Appendix A: Complexity Scoring Examples"},"content":"","type":"content","url":"/preregistration#appendix-a-complexity-scoring-examples","position":47},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"EITC Phase-In (Complexity: 2)","lvl2":"Appendix A: Complexity Scoring Examples"},"type":"lvl3","url":"/preregistration#eitc-phase-in-complexity-2","position":48},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"EITC Phase-In (Complexity: 2)","lvl2":"Appendix A: Complexity Scoring Examples"},"content":"0 conditionals (single formula)\n\n2 parameters (phase_in_rate, earned_income_amount)\n\n0 external references\n\nScore: 2","type":"content","url":"/preregistration#eitc-phase-in-complexity-2","position":49},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"Full EITC (Complexity: 6)","lvl2":"Appendix A: Complexity Scoring Examples"},"type":"lvl3","url":"/preregistration#full-eitc-complexity-6","position":50},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"Full EITC (Complexity: 6)","lvl2":"Appendix A: Complexity Scoring Examples"},"content":"3 conditionals (phase-in, plateau, phase-out regions)\n\n5 parameters (rate, amount, max, po_start, po_rate)\n\n1 external reference (earned_income)\n\nScore: 6","type":"content","url":"/preregistration#full-eitc-complexity-6","position":51},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"AMT (Complexity: 12)","lvl2":"Appendix A: Complexity Scoring Examples"},"type":"lvl3","url":"/preregistration#amt-complexity-12","position":52},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl3":"AMT (Complexity: 12)","lvl2":"Appendix A: Complexity Scoring Examples"},"content":"5+ conditionals (exemption phase-out, rate brackets, preferences)\n\n8+ parameters\n\n5+ external references (regular tax, various deductions)\n\n2 nested conditionals\n\nScore: 12+","type":"content","url":"/preregistration#amt-complexity-12","position":53},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"Appendix B: Test Case Stratification"},"type":"lvl2","url":"/preregistration#appendix-b-test-case-stratification","position":54},{"hierarchy":{"lvl1":"Preregistration: AI-Driven Rules-as-Code Encoding","lvl2":"Appendix B: Test Case Stratification"},"content":"For each provision, test cases will be stratified across:\n\nIncome levels: 0, 10K, 25K, 50K, 75K, 100K, 150K, 200K, 500K, 1M\nFiling status: Single, MFJ, MFS, HoH, QW\nDependents: 0, 1, 2, 3, 4+\nAge: <65, 65+\nState: CA (for state tax provisions)\n\nPlus boundary cases at:\n\nExactly at threshold values\n\n$1 below/above thresholds\n\nZero income edge cases\n\nMaximum value edge cases","type":"content","url":"/preregistration#appendix-b-test-case-stratification","position":55},{"hierarchy":{"lvl1":"Results"},"type":"lvl1","url":"/results","position":0},{"hierarchy":{"lvl1":"Results"},"content":"Note\n\nResults will be populated as experiments are run. This section shows the planned structure and preliminary findings.","type":"content","url":"/results","position":1},{"hierarchy":{"lvl1":"Results","lvl2":"Preliminary Results"},"type":"lvl2","url":"/results#preliminary-results","position":2},{"hierarchy":{"lvl1":"Results","lvl2":"Preliminary Results"},"content":"","type":"content","url":"/results#preliminary-results","position":3},{"hierarchy":{"lvl1":"Results","lvl3":"EITC Phase-In (Simple Provision)","lvl2":"Preliminary Results"},"type":"lvl3","url":"/results#eitc-phase-in-simple-provision","position":4},{"hierarchy":{"lvl1":"Results","lvl3":"EITC Phase-In (Simple Provision)","lvl2":"Preliminary Results"},"content":"Configuration:\n\nStatute: 26 USC § 32(a)(1)\n\nTest cases: 36\n\nTarget accuracy: 95%\n\nResult:\n\nAccuracy: 100%\n\nIterations: 1\n\nTokens: 4,491\n\nCost: $0.023\n\nThe agent correctly encoded the phase-in formula on the first attempt:formula:\n  min(earned_income, earned_income_amount[n_qualifying_children])\n    * phase_in_rate[n_qualifying_children]","type":"content","url":"/results#eitc-phase-in-simple-provision","position":5},{"hierarchy":{"lvl1":"Results","lvl3":"Full EITC with Phase-Out (Medium Provision)","lvl2":"Preliminary Results"},"type":"lvl3","url":"/results#full-eitc-with-phase-out-medium-provision","position":6},{"hierarchy":{"lvl1":"Results","lvl3":"Full EITC with Phase-Out (Medium Provision)","lvl2":"Preliminary Results"},"content":"Configuration:\n\nStatute: 26 USC § 32 (full)\n\nTest cases: 104\n\nTarget accuracy: 85%\n\nResult:\n\nAccuracy: 100%\n\nIterations: 6\n\nCost: ~$0.15\n\nThe agent required multiple iterations to handle the phase-out logic:\n\nIteration\n\nAccuracy\n\nIssue\n\n1\n\n0%\n\nSyntax error in multi-line formula\n\n2\n\n0%\n\nRuntime error in expression\n\n3\n\n49%\n\nMissing phase-out calculation\n\n4\n\n0%\n\nSyntax error in conditional\n\n5\n\n0%\n\nIncorrect threshold reference\n\n6\n\n100%\n\nCorrect implementation","type":"content","url":"/results#full-eitc-with-phase-out-medium-provision","position":7},{"hierarchy":{"lvl1":"Results","lvl2":"Full Study Results"},"type":"lvl2","url":"/results#full-study-results","position":8},{"hierarchy":{"lvl1":"Results","lvl2":"Full Study Results"},"content":"To be completed after running all 15 provisions","type":"content","url":"/results#full-study-results","position":9},{"hierarchy":{"lvl1":"Results","lvl3":"H1: Convergence Rate","lvl2":"Full Study Results"},"type":"lvl3","url":"/results#h1-convergence-rate","position":10},{"hierarchy":{"lvl1":"Results","lvl3":"H1: Convergence Rate","lvl2":"Full Study Results"},"content":"Complexity\n\nProvisions\n\nConverged (≤10 iter)\n\nRate\n\nSimple\n\n5\n\nTBD\n\nTBD\n\nMedium\n\n5\n\nTBD\n\nTBD\n\nComplex\n\n5\n\nTBD\n\nTBD\n\nTotal\n\n15\n\nTBD\n\nTBD","type":"content","url":"/results#h1-convergence-rate","position":11},{"hierarchy":{"lvl1":"Results","lvl3":"H2: Complexity Scaling","lvl2":"Full Study Results"},"type":"lvl3","url":"/results#h2-complexity-scaling","position":12},{"hierarchy":{"lvl1":"Results","lvl3":"H2: Complexity Scaling","lvl2":"Full Study Results"},"content":"\n\n# Placeholder for regression analysis\n# iterations ~ complexity_score\n\n\n\n","type":"content","url":"/results#h2-complexity-scaling","position":13},{"hierarchy":{"lvl1":"Results","lvl3":"H3: Transfer Learning","lvl2":"Full Study Results"},"type":"lvl3","url":"/results#h3-transfer-learning","position":14},{"hierarchy":{"lvl1":"Results","lvl3":"H3: Transfer Learning","lvl2":"Full Study Results"},"content":"Provision Set\n\nMean Iterations\n\nStd\n\nFirst 5\n\nTBD\n\nTBD\n\nLast 5\n\nTBD\n\nTBD\n\nDifference\n\nTBD\n\n-","type":"content","url":"/results#h3-transfer-learning","position":15},{"hierarchy":{"lvl1":"Results","lvl3":"H4: Cost Analysis","lvl2":"Full Study Results"},"type":"lvl3","url":"/results#h4-cost-analysis","position":16},{"hierarchy":{"lvl1":"Results","lvl3":"H4: Cost Analysis","lvl2":"Full Study Results"},"content":"Complexity\n\nMean Cost\n\nRange\n\nSimple\n\nTBD\n\nTBD\n\nMedium\n\nTBD\n\nTBD\n\nComplex\n\nTBD\n\nTBD","type":"content","url":"/results#h4-cost-analysis","position":17},{"hierarchy":{"lvl1":"Results","lvl3":"H5: Failure Modes","lvl2":"Full Study Results"},"type":"lvl3","url":"/results#h5-failure-modes","position":18},{"hierarchy":{"lvl1":"Results","lvl3":"H5: Failure Modes","lvl2":"Full Study Results"},"content":"Category\n\nCount\n\nProportion\n\nAmbiguous statute\n\nTBD\n\nTBD\n\nMissing oracle\n\nTBD\n\nTBD\n\nOracle disagreement\n\nTBD\n\nTBD\n\nTemporal logic\n\nTBD\n\nTBD\n\nOther\n\nTBD\n\nTBD","type":"content","url":"/results#h5-failure-modes","position":19}]}